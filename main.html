<!DOCTYPE html>
<html>
          <head>
        <link rel="shortcut icon" href="#"/>
	<script type="text/javascript" src="test.js"></script>
	<script
	  type="text/javascript"
	  src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js">
	</script>
	<script type="text/javascript">
	  (function () {
		emailjs.init('5zUHPTFpXOmSM2Eww');
	  })();
	</script>
                     <meta charset="utf-8">
                          <title>情緒符號生成音樂主觀評比問卷</title>
		     <style>
			.left {
			  text-align: center;
			  margin-top: 10px;
			  margin-left:50px;
			  display: inline-block;
			  width:600px;
			  height:550px;
			  vertical-align: top;
			}
			.right{
			  text-align: center;
			  margin-top: 10px;
		      margin-left: 70px;
			  display: inline-block;
			  width:600px;
			  height:550px;
			  vertical-align: top;
			     }
			.topborder{
			  border: 1px outset black;
			  text-align: center;
			  margin-top: 5px;
			  margin-left:50px;
			  width: 1400px;
			  vertical-align:top;			
			}
		    .top{
			  text-align: center;
			  margin-top: 5px;
			  margin-left:50px;
			  width: 1400px;
			  vertical-align:top;
			}
		    .top2{
			  text-align: center;
			  margin-top: 10px;
			  margin-left:50px;
			  width: 1400px;
			  vertical-align:top;
			}
			.bob-container{
				margin: 0 auto;
				padding-left: 15px;
				padding-right: 15px;
			}
			.bob-row{
				margin-right: -15px;
				margin-left: -15px;
			}
			.choice{
			  text-align: center;
			  width: 220px;
			  margin-top: 5px;
			  margin-left: 5px;
			  display: inline-block;
			  vertical-align: top;
			}
		   .question{
			  text-align: center;
			  width: 220px;
			  margin-top: 5px;
			  margin-left: 5px;
			  display: inline-block;
			  vertical-align: top;
			}
		   .progresslabel{
			  text-align: center;
			  width: 210px;
			  margin-top: 0px;
			  margin-left: 20px;
			  display: inline-block;
			  vertical-align: top;
			     }
		   .progressbefore{
			  border: 5px double black;
			  text-align: center;
			  height: 0px;
			  width: 200px;
			  margin-top: 5px;
			  margin-left: 20px;
			  display: inline-block;
			  vertical-align: top;
			}
		   .progressafter{
			  border: 5px solid blue;
			  text-align: center;
			  width: 200px;
			  height: 0px;
			  margin-top: 5px;
			  margin-left: 20px;
			  display: inline-block;
			  vertical-align: top;
			}			     
		     </style>
		  
                            </head>
                              <body>
				<tbody>
				<div class="topborder">
				<h3>情緒符號音樂生成主觀評比問卷</h3>

				<div class="left">
				<h4>測試評分方式:</h4>
				<h5>每頁測試會出現七首鋼琴音樂，請在確實聽完每首音樂後，並完成下方問題。</h5><br>
				<h5>Arousal:情緒激動程度(1是最低，5是最高)</h5><br>
				<h5>Valence:情緒正負面(1是越負面，5是越正面)</h5><br>
				<h5>Humanness:音樂是否像人演奏的(1是越不像，5是越像)</h5><br>
				<h5>Richness:音樂內容有趣程度(1是越無趣，5是越有趣)</h5><br>	
				<h5>Overall Music Quality:整體而言的音樂品質(1是越差，5是越佳)</h5><br>
				</div>
				<div class="right" >
                		<h4>valence-arousal參考圖:</h4><br>
				<img style='height: 80%; width: 80%; object-fit: contain' src="https://github.com/yen52205/yen52205.github.io-music-1/blob/master/.assets/4Q.png?raw=true" alt="Valence-Arousal">				
				</div></div>
				
			
            <div>
            <div class="top">
		    <hr id="pg1" class="progressafter" width="100%" SIZE=3>
		    <hr id="pg2" class="progressbefore" width="100%" SIZE=3>
		    <hr id="pg3" class="progressbefore" width="100%" SIZE=3>
		    <hr id="pg4" class="progressbefore" width="100%" SIZE=3>            
	    </div> 
	    <div class="top">
	            <label class="progresslabel">第1頁</label>
	            <label class="progresslabel">第2頁</label>
	            <label class="progresslabel">第3頁</label>
	            <label class="progresslabel">第4頁</label>
            </div>		    
		    
            <form>
				<div class="top2">
					<fieldset id="sample1">
					<legend>Sample-1</legend>
					
					<!-- 2個並排 -->                       <!-- https://codepen.io/bob-cat/pen/XdbEaa --> <!--<div style="height:43px;">挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題</div>-->
					<div class="bob-container"> 
					<!--<div class="bob-row">-->
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/0/Score0.jpg?raw=true" height="200px">
					
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/0/Score8.jpg?raw=true" height="200px">
						  				
					</div><div class="question"><fieldset id="good0">
					<legend>服裝</legend>
					<label><input type="radio" value=1 name="good0">上</label>
					<label><input type="radio" value=2 name="good0">下</label>
					</fieldset></div></fieldset></div>

				<div class="top2">
					<fieldset id="sample2">
					<legend>Sample-2</legend>
					
					<!-- 2個並排 -->                       <!-- https://codepen.io/bob-cat/pen/XdbEaa --> <!--<div style="height:43px;">挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題</div>-->
					<div class="bob-container"> 
					<!--<div class="bob-row">-->
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/13/Score0.jpg?raw=true" height="200px">
					
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/13/Score8.jpg?raw=true" height="200px">
						  				
					</div><div class="question"><fieldset id="good13">
					<legend>服裝</legend>
					<label><input type="radio" value=1 name="good13">上</label>
					<label><input type="radio" value=2 name="good13">下</label>
					</fieldset></div></fieldset></div>


				<div class="top2">
					<fieldset id="sample3">
					<legend>Sample-3</legend>
						
						<!-- 2個並排 -->                       <!-- https://codepen.io/bob-cat/pen/XdbEaa --> <!--<div style="height:43px;">挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題</div>-->
						<div class="bob-container"> 
						<!--<div class="bob-row">-->
						<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/1796/Score0.jpg?raw=true" height="200px">
						
						<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/1796/Score8.jpg?raw=true" height="200px">
												  
					</div><div class="question"><fieldset id="good1796">
					<legend>服裝</legend>
					<label><input type="radio" value=1 name="good1796">上</label>
					<label><input type="radio" value=2 name="good1796">下</label>
					</fieldset></div></fieldset></div>

				<div class="top2">
					<fieldset id="sample4">
					<legend>Sample-4</legend>
					
					<!-- 2個並排 -->                       <!-- https://codepen.io/bob-cat/pen/XdbEaa --> <!--<div style="height:43px;">挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題</div>-->
					<div class="bob-container"> 
					<!--<div class="bob-row">-->
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/821/Score0.jpg?raw=true" height="200px">
					
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/821/Score8.jpg?raw=true" height="200px">
						  				
					</div><div class="question"><fieldset id="good821">
					<legend>服裝</legend>
					<label><input type="radio" value=1 name="good821">上</label>
					<label><input type="radio" value=2 name="good821">下</label>
					</fieldset></div></fieldset></div>

				<div class="top2">
					<fieldset id="sample5">
					<legend>Sample-5</legend>
					
					<!-- 2個並排 -->                       <!-- https://codepen.io/bob-cat/pen/XdbEaa --> <!--<div style="height:43px;">挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題</div>-->
					<div class="bob-container"> 
					<!--<div class="bob-row">-->
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/1962/Score0.jpg?raw=true" height="200px">
					
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/1962/Score8.jpg?raw=true" height="200px">
						  				
					</div><div class="question"><fieldset id="good1962">
					<legend>服裝</legend>
					<label><input type="radio" value=1 name="good1962">上</label>
					<label><input type="radio" value=2 name="good1962">下</label>
					</fieldset></div></fieldset></div>

				<div class="top2">
					<fieldset id="sample6">
					<legend>Sample-6</legend>
					
					<!-- 2個並排 -->                       <!-- https://codepen.io/bob-cat/pen/XdbEaa --> <!--<div style="height:43px;">挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題</div>-->
					<div class="bob-container"> 
					<!--<div class="bob-row">-->
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/2167/Score0.jpg?raw=true" height="200px">
					
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/2167/Score8.jpg?raw=true" height="200px">
						  				
					</div><div class="question"><fieldset id="good2167">
					<legend>服裝</legend>
					<label><input type="radio" value=1 name="good2167">上</label>
					<label><input type="radio" value=2 name="good2167">下</label>
					</fieldset></div></fieldset></div>

				<div class="top2">
					<fieldset id="sample7">
					<legend>Sample-7</legend>
					
					<!-- 2個並排 -->                       <!-- https://codepen.io/bob-cat/pen/XdbEaa --> <!--<div style="height:43px;">挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題</div>-->
					<div class="bob-container"> 
					<!--<div class="bob-row">-->
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/2418/Score0.jpg?raw=true" height="200px">
					
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/2418/Score8.jpg?raw=true" height="200px">
						  				
					</div><div class="question"><fieldset id="good2418">
					<legend>服裝</legend>
					<label><input type="radio" value=1 name="good2418">上</label>
					<label><input type="radio" value=2 name="good2418">下</label>
					</fieldset></div></fieldset></div>

				<div class="top2">
					<fieldset id="sample8">
					<legend>Sample-8</legend>
					
					<!-- 2個並排 -->                       <!-- https://codepen.io/bob-cat/pen/XdbEaa --> <!--<div style="height:43px;">挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題</div>-->
					<div class="bob-container"> 
					<!--<div class="bob-row">-->
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/20/Score0.jpg?raw=true" height="200px">
					
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/20/Score8.jpg?raw=true" height="200px">
						  				
					</div><div class="question"><fieldset id="good20">
					<legend>服裝</legend>
					<label><input type="radio" value=1 name="good20">上</label>
					<label><input type="radio" value=2 name="good20">下</label>
					</fieldset></div></fieldset></div>

				<div class="top2">
					<fieldset id="sample9">
					<legend>Sample-9</legend>
					
					<!-- 2個並排 -->                       <!-- https://codepen.io/bob-cat/pen/XdbEaa --> <!--<div style="height:43px;">挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題</div>-->
					<div class="bob-container"> 
					<!--<div class="bob-row">-->
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/1801/Score0.jpg?raw=true" height="200px">
					
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/1801/Score8.jpg?raw=true" height="200px">
						  				
					</div><div class="question"><fieldset id="good1801">
					<legend>服裝</legend>
					<label><input type="radio" value=1 name="good1801">上</label>
					<label><input type="radio" value=2 name="good1801">下</label>
					</fieldset></div></fieldset></div>

				<div class="top2">
					<fieldset id="sample10">
					<legend>Sample-10</legend>
					
					<!-- 2個並排 -->                       <!-- https://codepen.io/bob-cat/pen/XdbEaa --> <!--<div style="height:43px;">挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題</div>-->
					<div class="bob-container"> 
					<!--<div class="bob-row">-->
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/337/Score0.jpg?raw=true" height="200px">
					
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/337/Score8.jpg?raw=true" height="200px">
						  				
					</div><div class="question"><fieldset id="good337">
					<legend>服裝</legend>
					<label><input type="radio" value=1 name="good337">上</label>
					<label><input type="radio" value=2 name="good337">下</label>
					</fieldset></div></fieldset></div>

    
            <div class="top">
            <p id="info">---</p>	
            <input width=200 height=100 type="button" id="send" onclick=updateAudio() value="下一組">	
            </div>			

			
	        </div>


		<div class="top">
	            <label class="progresslabel">第1頁</label>
	            <label class="progresslabel">第2頁</label>
	            <label class="progresslabel">第3頁</label>
	            <label class="progresslabel">第4頁</label>
            </div>		    
		    
            <form>
				<div class="top2">
					<fieldset id="sample11">
					<legend>Sample-11</legend>
					
					<!-- 2個並排 -->                       <!-- https://codepen.io/bob-cat/pen/XdbEaa --> <!--<div style="height:43px;">挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題</div>-->
					<div class="bob-container"> 
					<!--<div class="bob-row">-->
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/1609/Score0.jpg?raw=true" height="200px">
					
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/1609/Score8.jpg?raw=true" height="200px">
						  				
					</div><div class="question"><fieldset id="good1609">
					<legend>服裝</legend>
					<label><input type="radio" value=1 name="good1609">上</label>
					<label><input type="radio" value=2 name="good1609">下</label>
					</fieldset></div></fieldset></div>

				<div class="top2">
					<fieldset id="sample12">
					<legend>Sample-12</legend>
					
					<!-- 2個並排 -->                       <!-- https://codepen.io/bob-cat/pen/XdbEaa --> <!--<div style="height:43px;">挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題</div>-->
					<div class="bob-container"> 
					<!--<div class="bob-row">-->
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/2612/Score0.jpg?raw=true" height="200px">
					
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/2612/Score8.jpg?raw=true" height="200px">
						  				
					</div><div class="question"><fieldset id="good2612">
					<legend>服裝</legend>
					<label><input type="radio" value=1 name="good2612">上</label>
					<label><input type="radio" value=2 name="good2612">下</label>
					</fieldset></div></fieldset></div>


				<div class="top2">
					<fieldset id="sample3">
					<legend>Sample-3</legend>
						
						<!-- 2個並排 -->                       <!-- https://codepen.io/bob-cat/pen/XdbEaa --> <!--<div style="height:43px;">挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題</div>-->
						<div class="bob-container"> 
						<!--<div class="bob-row">-->
						<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/1796/Score0.jpg?raw=true" height="200px">
						
						<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/1796/Score8.jpg?raw=true" height="200px">
												  
					</div><div class="question"><fieldset id="good1796">
					<legend>服裝</legend>
					<label><input type="radio" value=1 name="good1796">上</label>
					<label><input type="radio" value=2 name="good1796">下</label>
					</fieldset></div></fieldset></div>

				<div class="top2">
					<fieldset id="sample4">
					<legend>Sample-4</legend>
					
					<!-- 2個並排 -->                       <!-- https://codepen.io/bob-cat/pen/XdbEaa --> <!--<div style="height:43px;">挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題</div>-->
					<div class="bob-container"> 
					<!--<div class="bob-row">-->
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/821/Score0.jpg?raw=true" height="200px">
					
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/821/Score8.jpg?raw=true" height="200px">
						  				
					</div><div class="question"><fieldset id="good821">
					<legend>服裝</legend>
					<label><input type="radio" value=1 name="good821">上</label>
					<label><input type="radio" value=2 name="good821">下</label>
					</fieldset></div></fieldset></div>

				<div class="top2">
					<fieldset id="sample5">
					<legend>Sample-5</legend>
					
					<!-- 2個並排 -->                       <!-- https://codepen.io/bob-cat/pen/XdbEaa --> <!--<div style="height:43px;">挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題</div>-->
					<div class="bob-container"> 
					<!--<div class="bob-row">-->
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/1962/Score0.jpg?raw=true" height="200px">
					
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/1962/Score8.jpg?raw=true" height="200px">
						  				
					</div><div class="question"><fieldset id="good1962">
					<legend>服裝</legend>
					<label><input type="radio" value=1 name="good1962">上</label>
					<label><input type="radio" value=2 name="good1962">下</label>
					</fieldset></div></fieldset></div>

				<div class="top2">
					<fieldset id="sample6">
					<legend>Sample-6</legend>
					
					<!-- 2個並排 -->                       <!-- https://codepen.io/bob-cat/pen/XdbEaa --> <!--<div style="height:43px;">挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題</div>-->
					<div class="bob-container"> 
					<!--<div class="bob-row">-->
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/2167/Score0.jpg?raw=true" height="200px">
					
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/2167/Score8.jpg?raw=true" height="200px">
						  				
					</div><div class="question"><fieldset id="good2167">
					<legend>服裝</legend>
					<label><input type="radio" value=1 name="good2167">上</label>
					<label><input type="radio" value=2 name="good2167">下</label>
					</fieldset></div></fieldset></div>

				<div class="top2">
					<fieldset id="sample7">
					<legend>Sample-7</legend>
					
					<!-- 2個並排 -->                       <!-- https://codepen.io/bob-cat/pen/XdbEaa --> <!--<div style="height:43px;">挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題</div>-->
					<div class="bob-container"> 
					<!--<div class="bob-row">-->
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/2418/Score0.jpg?raw=true" height="200px">
					
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/2418/Score8.jpg?raw=true" height="200px">
						  				
					</div><div class="question"><fieldset id="good2418">
					<legend>服裝</legend>
					<label><input type="radio" value=1 name="good2418">上</label>
					<label><input type="radio" value=2 name="good2418">下</label>
					</fieldset></div></fieldset></div>

				<div class="top2">
					<fieldset id="sample8">
					<legend>Sample-8</legend>
					
					<!-- 2個並排 -->                       <!-- https://codepen.io/bob-cat/pen/XdbEaa --> <!--<div style="height:43px;">挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題</div>-->
					<div class="bob-container"> 
					<!--<div class="bob-row">-->
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/20/Score0.jpg?raw=true" height="200px">
					
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/20/Score8.jpg?raw=true" height="200px">
						  				
					</div><div class="question"><fieldset id="good20">
					<legend>服裝</legend>
					<label><input type="radio" value=1 name="good20">上</label>
					<label><input type="radio" value=2 name="good20">下</label>
					</fieldset></div></fieldset></div>

				<div class="top2">
					<fieldset id="sample9">
					<legend>Sample-9</legend>
					
					<!-- 2個並排 -->                       <!-- https://codepen.io/bob-cat/pen/XdbEaa --> <!--<div style="height:43px;">挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題</div>-->
					<div class="bob-container"> 
					<!--<div class="bob-row">-->
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/1801/Score0.jpg?raw=true" height="200px">
					
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/1801/Score8.jpg?raw=true" height="200px">
						  				
					</div><div class="question"><fieldset id="good1801">
					<legend>服裝</legend>
					<label><input type="radio" value=1 name="good1801">上</label>
					<label><input type="radio" value=2 name="good1801">下</label>
					</fieldset></div></fieldset></div>

				<div class="top2">
					<fieldset id="sample10">
					<legend>Sample-10</legend>
					
					<!-- 2個並排 -->                       <!-- https://codepen.io/bob-cat/pen/XdbEaa --> <!--<div style="height:43px;">挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題挖系標題</div>-->
					<div class="bob-container"> 
					<!--<div class="bob-row">-->
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/337/Score0.jpg?raw=true" height="200px">
					
					<img src="https://github.com/YPChao1009/outfit/blob/master/.assets/337/Score8.jpg?raw=true" height="200px">
						  				
					</div><div class="question"><fieldset id="good337">
					<legend>服裝</legend>
					<label><input type="radio" value=1 name="good337">上</label>
					<label><input type="radio" value=2 name="good337">下</label>
					</fieldset></div></fieldset></div>

    
            <div class="top">
            <p id="info">---</p>	
            <input width=200 height=100 type="button" id="send" onclick=updateAudio() value="下一組">	
            </div>			

			
	        </div>
</body>
            <script>
			//model folder
			const old_model_folder = ["https://raw.githubusercontent.com/yen52205/music_content/master/pretrained_transformer_renamed/",
			                      "https://raw.githubusercontent.com/yen52205/music_content/master/0927_generated_songs_1200-6/",
								  "https://raw.githubusercontent.com/yen52205/music_content/master/model_8_renamed/",
								  "https://raw.githubusercontent.com/yen52205/music_content/master/model_3_renamed/",
								  "https://raw.githubusercontent.com/yen52205/music_content/master/model_25_renamed/",
								  "https://raw.githubusercontent.com/yen52205/music_content/master/0925_generated_songs_1200-2/",
						                  "https://raw.githubusercontent.com/yen52205/music_content/master/emopia/",
						 ];
			var model_folder = [];
			//select 4 song idx	  
			const random_song_idx = [];
			var song_counter = 0;
			while(song_counter<1){
				    random_idx = Math.floor(Math.random()*240)+1;
					random_choice = (4*random_idx-1);
					if (random_song_idx.includes(random_choice)==true){
					    continue;
					}else{
					    random_song_idx.push(random_choice);
						random_song_idx.push(random_choice+1);
						random_song_idx.push(random_choice+2);
						random_song_idx.push(random_choice+3);
					}
				song_counter+=1;
			}

			//random choose test model place
			let numbers = [0, 1, 2, 3, 4, 5, 6];
			let shuffledNumbers = numbers.sort(function () {
			  return Math.random() - 0.5;
			});
			for (let i=0;i<7;i++){
			    model_folder.push(old_model_folder[shuffledNumbers[i]]);
			}
			
			//complete audio name for audio display
			const audio_name = [];
			var emo = 0;
			for (let i=0;i<4;i++){
			   emo = (random_song_idx[i]+1)%4+1;
			   audio_name.push('emo_'+emo+'_song_'+random_song_idx[i]+'.mp3');
			}
			
			var page_idx = 0;
			var audio_1 = model_folder[0]+audio_name[page_idx];
			var audio_2 = model_folder[1]+audio_name[page_idx];
			var audio_3 = model_folder[2]+audio_name[page_idx];
			var audio_4 = model_folder[3]+audio_name[page_idx];
			var audio_5 = model_folder[4]+audio_name[page_idx];
			var audio_6 = model_folder[5]+audio_name[page_idx];
			var audio_7 = model_folder[6]+audio_name[page_idx];
			
			document.getElementById("audio-1").src = audio_1;
			document.getElementById("audio-2").src = audio_2;
			document.getElementById("audio-3").src = audio_3;			
			document.getElementById("audio-4").src = audio_4;
			document.getElementById("audio-5").src = audio_5;
			document.getElementById("audio-6").src = audio_6;
			document.getElementById("audio-7").src = audio_7;
			
			//store user choice into string
			var answer_str= "audioName,arousal,valence,humanness,richness,overall,";
			
			function storeContent(){
			  var tmp_str = "";
			  var audio_files = [audio_1,audio_2,audio_3,audio_4,audio_5,audio_6,audio_7];
			  var checked_list = [];
			  for (let i=1; i<8;i++){ 
			      var query_name = ["arousal-"+i,"valence-"+i,"humanness-"+i,"richness-"+i,"overall-"+i]
				  var audio_path = audio_files[i-1];
				  var aa = 'input[name="'+query_name[0]+'"]:checked';
				  var vv = 'input[name="'+query_name[1]+'"]:checked';
				  var hh = 'input[name="'+query_name[2]+'"]:checked';
				  var rr = 'input[name="'+query_name[3]+'"]:checked';
				  var oo = 'input[name="'+query_name[4]+'"]:checked';
				  try{
					var a = document.querySelector(aa).value;
					var v = document.querySelector(vv).value;
					var h = document.querySelector(hh).value;
					var r = document.querySelector(rr).value;	
					var o = document.querySelector(oo).value;}
				  catch{
				    alert('請確認 sample-'+i+' 是否未完成!');
					return false;
				  }
                  tmp_str += `${audio_path},${a},${v},${h},${r},${o},` ;		
                  checked_list.push(`${aa}`);
				  checked_list.push(`${vv}`);
				  checked_list.push(`${hh}`);
				  checked_list.push(`${rr}`);
				  checked_list.push(`${oo}`);
			  }
			  
			  for (let c in checked_list){
				document.querySelector(checked_list[c]).checked = false;
			  }
			  
			  answer_str += tmp_str;
			  return true;		
			}
		   
		   //end the test and send email
		   function end() {
		   const d = new Date();
           var year = d.getFullYear();
		   var month = d.getMonth();
		   var day = d.getDate();
		   var hours = d.getHours();
		   var mins = d.getMinutes();
		   var timestr = `${year}${month}${day}_${hours}${mins}`;
		   var Gender = document.querySelector('input[name="gender"]:checked').value;
		   var Age = document.getElementById("age").value;
		   var userName = document.getElementById("username").value;
			
			var templateParams = {
				user_name: String(userName),
				age:String(Age),
				gender: String(Gender),
				date: String(timestr),
				content: String(answer_str)
			};
			//const serviceID = 'service_gm2j5rn';                    要申請
			//const templateID = 'template_lbuijiq';                  要申請
			emailjs.send(serviceID, templateID, templateParams)
				.then(function (response) {
					console.log('SUCCESS!', response.status, response.text);
				}, function (error) {
				        alert('error happened,please contact the author!');
					//console.log('FAILED...', error);
				});
			}
			
			
			//update audio source and provide user information
			function updateAudio(){
				var flag = storeContent();
				if (flag==true){
					if (page_idx<3){ //idx<11
						alert('剩餘'+(3-page_idx)+'頁；請繼續回答......');
						model_folder = [];
						let shuffledNumbers = numbers.sort(function () {
						  return Math.random() - 0.5;
						});
						for (let i=0;i<7;i++){
			    				model_folder.push(old_model_folder[shuffledNumbers[i]]);
						}
						page_idx += 1;
						audio_1 = model_folder[0]+audio_name[page_idx];
						audio_2 = model_folder[1]+audio_name[page_idx];
						audio_3 = model_folder[2]+audio_name[page_idx];
						audio_4 = model_folder[3]+audio_name[page_idx];
						audio_5 = model_folder[4]+audio_name[page_idx];
						audio_6 = model_folder[5]+audio_name[page_idx];
						audio_7 = model_folder[6]+audio_name[page_idx];
						document.getElementById("audio-1").src = audio_1;
						document.getElementById("audio-2").src = audio_2;
						document.getElementById("audio-3").src = audio_3;			
						document.getElementById("audio-4").src = audio_4;
						document.getElementById("audio-5").src = audio_5;
						document.getElementById("audio-6").src = audio_6;
						document.getElementById("audio-7").src = audio_7;
						
						document.getElementById("pg"+(page_idx+1)).className = "progressafter" ;
						if (page_idx==3){ //idx==11
							document.getElementById("send").value = "最後一組，確認送出";
							document.getElementById("info").innerHTML = '<label>姓名:</label><input type="text" id="username" name="姓名:" value="Unknown"><label>年齡:</label><input type="text" id="age" name="年齡:" value="Unknown"><label><input type="radio" value="female" name="gender">女性</label><label><input type="radio" value="others" name="gender" checked>其他</label><label><input type="radio" value="male" name="gender">男性</label>';
						}
					}else{
						end();
						page_idx = 0;
						alert('測驗結束，謝謝配合!');
						window.location.href = "https://yen52205.github.io/yen52205.github.io-music-1/end_page.html";
					}
			}
			}
			</script>
</html>
